<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDONinja SDK - LLM Compatibility Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .code-block {
            background: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
        }
        .output {
            background: #e8f5e9;
            border: 1px solid #4CAF50;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            min-height: 50px;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            padding: 5px 10px;
            border-radius: 3px;
            display: inline-block;
            margin: 5px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>VDONinja SDK - LLM Compatibility Test</h1>
    <p>This page demonstrates how the SDK handles common patterns used by LLMs/AI assistants.</p>
    
    <div class="test-section">
        <h2>Test 1: Setting Properties Directly (Common LLM Pattern)</h2>
        <p>LLMs often try to set properties directly on the SDK instance:</p>
        
        <div class="code-block">// Common LLM pattern (not recommended but now supported)
let vdo = new VDONinjaSDK();
vdo.streamID = "myStreamID";
vdo.roomid = "testRoom";
vdo.label = "My Stream";</div>
        
        <button onclick="testDirectProperties()">Run Test</button>
        <div id="test1-output" class="output"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Constructor Options (Also Common)</h2>
        <p>Some LLMs pass these values in the constructor:</p>
        
        <div class="code-block">// Constructor pattern (now supported)
let vdo = new VDONinjaSDK({
    streamID: "constructorStreamID",
    roomid: "constructorRoom",
    label: "Constructor Stream"
});</div>
        
        <button onclick="testConstructorOptions()">Run Test</button>
        <div id="test2-output" class="output"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Correct Usage (Recommended)</h2>
        <p>The proper way to use the SDK:</p>
        
        <div class="code-block">// Recommended pattern
let vdo = new VDONinjaSDK();
await vdo.connect();
await vdo.publish(stream, { 
    streamID: "properStreamID",
    label: "Proper Stream"
});</div>
        
        <button onclick="testCorrectUsage()">Run Test</button>
        <div id="test3-output" class="output"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 4: Mixed Usage (Fallback Support)</h2>
        <p>Testing fallback when some values are set as properties and others in method:</p>
        
        <div class="code-block">// Mixed pattern (property fallback)
let vdo = new VDONinjaSDK();
vdo.streamID = "fallbackStreamID";  // Set as property (shows warning)
await vdo.announce({ 
    label: "Override Label"  // Override in method
});  // Will use fallbackStreamID</div>
        
        <button onclick="testMixedUsage()">Run Test</button>
        <div id="test4-output" class="output"></div>
    </div>
    
    <div class="test-section">
        <h2>Console Output</h2>
        <p>Open the browser console to see warnings and guidance when properties are set incorrectly.</p>
        <div class="warning">
            <strong>Note:</strong> When properties are set directly, the SDK will show helpful warnings in the console 
            explaining the correct usage, but will still work to maintain compatibility.
        </div>
    </div>

    <script src="vdoninja-sdk.js"></script>
    <script>
        function logOutput(elementId, message, isError = false) {
            const output = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            const status = isError ? 'error' : 'success';
            output.innerHTML += `<div class="status ${status}">[${timestamp}] ${message}</div>\n`;
        }
        
        async function testDirectProperties() {
            const output = 'test1-output';
            document.getElementById(output).innerHTML = '';
            
            try {
                // Common LLM pattern
                let vdo = new VDONinjaSDK({ debug: true });
                
                logOutput(output, 'Created SDK instance');
                
                // These will trigger warnings but still work
                vdo.streamID = "myStreamID";
                logOutput(output, 'Set streamID property (check console for warning)');
                
                vdo.roomid = "testRoom";
                logOutput(output, 'Set roomid property (check console for warning)');
                
                vdo.label = "My Stream";
                logOutput(output, 'Set label property (check console for warning)');
                
                // Check if values are stored
                logOutput(output, `streamID getter returns: ${vdo.streamID}`);
                logOutput(output, `roomid getter returns: ${vdo.roomid}`);
                logOutput(output, `label getter returns: ${vdo.label}`);
                
                logOutput(output, '✓ Properties set successfully (with warnings)');
            } catch (error) {
                logOutput(output, `Error: ${error.message}`, true);
            }
        }
        
        async function testConstructorOptions() {
            const output = 'test2-output';
            document.getElementById(output).innerHTML = '';
            
            try {
                // Constructor pattern
                let vdo = new VDONinjaSDK({
                    streamID: "constructorStreamID",
                    roomid: "constructorRoom",
                    label: "Constructor Stream",
                    debug: true
                });
                
                logOutput(output, 'Created SDK with constructor options');
                
                // Check if values were set
                logOutput(output, `streamID: ${vdo.streamID || 'Not set yet'}`);
                logOutput(output, `room: ${vdo.roomid}`);
                logOutput(output, `label: ${vdo.label}`);
                
                logOutput(output, '✓ Constructor options handled correctly');
            } catch (error) {
                logOutput(output, `Error: ${error.message}`, true);
            }
        }
        
        async function testCorrectUsage() {
            const output = 'test3-output';
            document.getElementById(output).innerHTML = '';
            
            try {
                // Correct pattern
                let vdo = new VDONinjaSDK({ debug: true });
                logOutput(output, 'Created SDK instance');
                
                // Note: We're not actually connecting/publishing here since it requires a real connection
                logOutput(output, 'Would connect with: await vdo.connect()');
                logOutput(output, 'Would publish with: await vdo.publish(stream, { streamID: "properStreamID", label: "Proper Stream" })');
                
                logOutput(output, '✓ This is the recommended usage pattern');
            } catch (error) {
                logOutput(output, `Error: ${error.message}`, true);
            }
        }
        
        async function testMixedUsage() {
            const output = 'test4-output';
            document.getElementById(output).innerHTML = '';
            
            try {
                // Mixed pattern
                let vdo = new VDONinjaSDK({ debug: true });
                logOutput(output, 'Created SDK instance');
                
                // Set streamID as property (fallback)
                vdo.streamID = "fallbackStreamID";
                logOutput(output, 'Set streamID as property: "fallbackStreamID"');
                
                // In real usage, this would use the fallback streamID
                logOutput(output, 'Would call announce with only label specified');
                logOutput(output, 'The SDK would use "fallbackStreamID" since no streamID in method call');
                
                // Also test override
                vdo.streamID = "willBeOverridden";
                logOutput(output, 'Set streamID property to "willBeOverridden"');
                logOutput(output, 'If publish() is called with streamID: "override", it will use "override"');
                
                logOutput(output, '✓ Fallback mechanism works correctly');
            } catch (error) {
                logOutput(output, `Error: ${error.message}`, true);
            }
        }
        
        // Auto-run first test on load
        window.addEventListener('load', () => {
            console.log('%c VDONinja SDK LLM Compatibility Test ', 
                'background: #4CAF50; color: white; padding: 5px 10px; border-radius: 3px; font-weight: bold');
            console.log('This page tests how the SDK handles common LLM usage patterns.');
            console.log('Watch for warning messages when properties are set directly.');
        });
    </script>
</body>
</html>